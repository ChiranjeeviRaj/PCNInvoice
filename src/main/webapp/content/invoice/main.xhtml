<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<h:head>
	<link rel="stylesheet" type="text/css"
		href="#{facesContext.externalContext.requestContextPath}/resources/css/pcn.css" />
</h:head>

<h:body>
	<ui:composition>
		<h2>PCN Invoice Generator</h2>
		<h:form enctype="multipart/form-data">

			<p:growl id="messages" showDetail="true" />
			<p:panel>
				<h:outputText value="Please select: " for="fileType" />
				<p:selectOneMenu id="fileType" value="#{invoiceMB.fileType}"
					required="true" requiredMessage="Please Select Parcels/Palets">
					<f:selectItem itemLabel="Select One" itemValue="0" />
					<f:selectItem itemLabel="Parcels" itemValue="1" />
					<f:selectItem itemLabel="Palets" itemValue="2" />
				</p:selectOneMenu>
			</p:panel>
			<p:panel>
				<p:fileUpload value="#{invoiceMB.file}"
					mode="simple" allowTypes="/(\.|\/)(xls)$/" sizeLimit="100000" update="messages" />

			</p:panel>
			
			<p:panel>
							<p:dialog modal="true" widgetVar="statusDialog" header="Status"
					draggable="false" closable="false" resizable="false">
					<p:graphicImage
					 value="#{facesContext.externalContext.requestContextPath}/resources/images/ajax_loading_bar.gif" />
				</p:dialog>


					<p:commandButton id="invoiceLink" value="Generate Invoice" ajax="true" update="messages"
						onclick="PrimeFaces.monitorDownload(start, stop)" 
						actionListener="#{invoiceMB.uploadXlsAndGenerateInvoice}"
						icon="ui-icon-arrowthichk-s">
					<p:fileDownload value="#{invoiceMB.pdfInvoiceFile}" />
					</p:commandButton>
			</p:panel>
		</h:form>
			<script type="text/javascript">
		function start() {
			PF('statusDialog').show();
		}

		function stop() {
			PF('statusDialog').hide();
		}
	</script>
	</ui:composition>
</h:body>
</html>
